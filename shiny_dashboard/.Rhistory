matr <- selected_matr
} else if (!is.null(selected_name) && selected_name != "- not selected -") {
row <- students_sorted_name[students_sorted_name$full_name == selected_name, ]
matr <- row$matriculation_number
} else {
return("-")
}
# Load grades
student_grades <- dbGetQuery(
con,
paste0("SELECT grade FROM grade WHERE matriculation_number = '", matr, "'")
)
if (nrow(student_grades) == 0) return("-")
round(mean(student_grades$grade, na.rm = TRUE), 2)
})
# Disconnect DB when session ends
session$onSessionEnded(function() dbDisconnect(con))
}
runApp()
server <- function(input, output, session) {
library(DBI)
library(RPostgres)
library(jsonlite)
library(shinyjs)
# ---------------- Load DB Credentials ----------------
db_config <- fromJSON("../user_login_config.json")
con <- dbConnect(
RPostgres::Postgres(),
dbname   = db_config$database,
host     = db_config$host,
port     = db_config$port,
user     = db_config$username,
password = db_config$password
)
# ---------------- Load Student Data ----------------
students <- dbGetQuery(con, "
SELECT matriculation_number, first_name, last_name FROM student
")
students_sorted_matr <- students[order(students$matriculation_number), ]
students_sorted_name <- students[order(students$last_name, students$first_name), ]
students_sorted_name$full_name <- paste(students_sorted_name$first_name,
students_sorted_name$last_name)
name_choices <- c("- not selected -", students_sorted_name$full_name)
matr_choices <- c("- not selected -", students_sorted_matr$matriculation_number)
# ============================================================================
# Dynamic UI: Student Name
# ============================================================================
output$student_name_ui <- renderUI({
req(input$student_toggle == "One Student")
name_selected <- !is.null(input$name_select) && input$name_select != "- not selected -"
matr_selected <- !is.null(input$matnr_select) && input$matnr_select != "- not selected -"
if (!matr_selected) {
selectInput(
"name_select",
label = tags$label("Student Name:", class = "filter-label"),
choices = name_choices,
selected = input$name_select %||% "- not selected -"
)
} else {
div(
class = "static-text-container",
tags$label("Student Name:", class = "filter-label"),
div(
class = "static-text-input",
style = "margin-top: 0;",  # aligns with dropdowns
{
row <- students_sorted_name[
students_sorted_name$matriculation_number == input$matnr_select, ]
paste(row$first_name, row$last_name)
}
)
)
}
})
# ============================================================================
# Dynamic UI: Matriculation Number
# ============================================================================
output$matnr_ui <- renderUI({
req(input$student_toggle == "One Student")
name_selected <- !is.null(input$name_select) && input$name_select != "- not selected -"
matr_selected <- !is.null(input$matnr_select) && input$matnr_select != "- not selected -"
if (!name_selected) {
selectInput(
"matnr_select",
label = tags$label("Matriculation Number:", class = "filter-label"),
choices = matr_choices,
selected = input$matnr_select %||% "- not selected -"
)
} else {
div(
class = "static-text-container",
tags$label("Matriculation Number:", class = "filter-label"),
div(
class = "static-text-input",
style = "margin-top: 0;",  # aligns with dropdowns
{
row <- students_sorted_name[
students_sorted_name$full_name == input$name_select, ]
row$matriculation_number
}
)
)
}
})
# ============================================================================
# Show / Hide Reset Button
# ============================================================================
observe({
if (
(!is.null(input$name_select) && input$name_select != "- not selected -") ||
(!is.null(input$matnr_select) && input$matnr_select != "- not selected -")
) {
shinyjs::show("reset_filters")
} else {
shinyjs::hide("reset_filters")
}
})
# ============================================================================
# Reset all dropdowns
# ============================================================================
observeEvent(input$reset_filters, {
updateSelectInput(session, "name_select", selected = "- not selected -")
updateSelectInput(session, "matnr_select", selected = "- not selected -")
})
# ============================================================================
# Compute GPA for selected student
# ============================================================================
output$student_gpa <- renderText({
req(input$student_toggle == "One Student")
selected_matr <- input$matnr_select
selected_name <- input$name_select
# Resolve matriculation number
if (!is.null(selected_matr) && selected_matr != "- not selected -") {
matr <- selected_matr
} else if (!is.null(selected_name) && selected_name != "- not selected -") {
row <- students_sorted_name[students_sorted_name$full_name == selected_name, ]
matr <- row$matriculation_number
} else {
return("-")
}
# Load grades
student_grades <- dbGetQuery(
con,
paste0("SELECT grade FROM grade WHERE matriculation_number = '", matr, "'")
)
if (nrow(student_grades) == 0) return("-")
round(mean(student_grades$grade, na.rm = TRUE), 2)
})
# Disconnect DB when session ends
session$onSessionEnded(function() dbDisconnect(con))
}
library(shiny)
library(shinydashboard)
library(shinyjs)
# ------------------------ CUSTOM CSS ------------------------------------------
customCSS <- "
/* Top header logo */
.top-header-logo {
height: 40px;
position: absolute;
right: 10px;
top: 8px;
}
/* Tab header */
.tab-header {
text-align: center;
font-weight: bold;
font-size: 18px;
margin-bottom: 10px;
}
/* Student filter row: flex container */
.student-filters-row {
display: flex;
align-items: center;       /* vertical alignment of all filter-blocks */
gap: 20px;                 /* horizontal spacing */
padding-top: 10px;
}
/* Each filter block stacks label above input */
.filter-block {
display: flex;
flex-direction: column;
width: 220px;
height: 80px;              /* fixed height to prevent jumping */
justify-content: flex-start;
}
/* Unified label style */
.filter-label,
.control-label,
.static-text-label,
.unified-label {
font-weight: bold;
height: 22px;              /* fixed label height */
line-height: 22px;         /* centers label text vertically */
margin: 0 0 6px 0;         /* spacing below label */
padding: 0;
position: relative;
top: 2px;                  /* fine-tune vertical alignment */
}
/* Dropdown input */
.selectize-input {
height: 40px !important;
border-radius: 45px !important;
padding-left: 10px !important;
display: flex !important;
align-items: center !important;
}
/* Dropdown menu */
.selectize-dropdown {
border-radius: 10px !important;
}
/* Static text input */
.static-text-input {
height: 40px;
width: 300px;
border-radius: 45px;
border: 1px solid #ccc;
padding: 0 10px;
display: flex;
align-items: center;
background-color: white;
}
/* Static text container */
.static-text-container {
display: flex;
flex-direction: column;
justify-content: flex-start;
}
/* Radio buttons alignment */
.shiny-options-group {
margin-top: 6px;          /* align with inputs */
}
/* Reset button */
.reset-btn {
background-color: #4da3ff;
color: white;
border-radius: 45px;
height: 40px;
display: flex;
align-items: center;
justify-content: center;
border: none;
padding: 0 20px;
margin-top: 6px;          /* align with inputs */
}
/* GPA card */
.gpa-card h4 {
margin: 0;
font-weight: normal;
}
.gpa-card h2 {
margin: 0;
font-size: 28px;
font-weight: bold;
}
"
# ---- UI ----------------------------------------------------------------------
ui <- dashboardPage(
dashboardHeader(
title = "HS-Dashboard",
tags$li(class = "dropdown",
tags$img(src = "HS_Aalen_Icon.png", class = "top-header-logo")
)
),
dashboardSidebar(
sidebarMenu(
id = "tabs",
menuItem("Student-Information", tabName = "studentinfo", icon = icon("dashboard")),
menuItem("Module-Information", tabName = "moduleinfo", icon = icon("th"))
)
),
dashboardBody(
tags$head(tags$style(HTML(customCSS))),
useShinyjs(),
uiOutput("tabHeader"),
tabItems(
# --- Tab 1: Student Information ---
tabItem(tabName = "studentinfo",
fluidRow(
class = "student-filters-row",
# Container for all filter blocks
div(style = "display: flex; align-items: center; gap: 20px;",
# Radio buttons
div(class = "filter-block",
radioButtons(
"student_toggle",
label = "Select Student:",
choices = c("All Students", "One Student"),
inline = TRUE
)
),
# Dynamic Name filter
div(class = "filter-block",
uiOutput("student_name_ui")
),
# Dynamic Matriculation Number filter
div(class = "filter-block",
uiOutput("matnr_ui")
),
# Reset button
div(class = "filter-block",
actionButton("reset_filters", "Reset Selection", class = "reset-btn")
)
)
),
# GPA Card
fluidRow(
column(
width = 3,
div(
id = "gpa_card",
class = "gpa-card",
style = "
background-color: #f0f4ff;
border-radius: 15px;
height: 100px;
display: flex;
flex-direction: column;
justify-content: center;
align-items: center;
margin-bottom: 20px;
",
h4("Overall GPA"),
h2(textOutput("student_gpa", inline = TRUE))
)
)
)
),
# --- Tab 2: Module Information ---
tabItem(tabName = "moduleinfo",
h2("Module Information content")
)
)
)
)
server <- function(input, output, session) {
library(DBI)
library(RPostgres)
library(jsonlite)
library(shinyjs)
# ---------------- Load DB Credentials ----------------
db_config <- fromJSON("../user_login_config.json")
con <- dbConnect(
RPostgres::Postgres(),
dbname   = db_config$database,
host     = db_config$host,
port     = db_config$port,
user     = db_config$username,
password = db_config$password
)
# ---------------- Load Student Data ----------------
students <- dbGetQuery(con, "
SELECT matriculation_number, first_name, last_name FROM student
")
students_sorted_matr <- students[order(students$matriculation_number), ]
students_sorted_name <- students[order(students$last_name, students$first_name), ]
students_sorted_name$full_name <- paste(students_sorted_name$first_name,
students_sorted_name$last_name)
name_choices <- c("- not selected -", students_sorted_name$full_name)
matr_choices <- c("- not selected -", students_sorted_matr$matriculation_number)
# ============================================================================
# Dynamic UI: Student Name
# ============================================================================
output$student_name_ui <- renderUI({
req(input$student_toggle == "One Student")
name_selected <- !is.null(input$name_select) && input$name_select != "- not selected -"
matr_selected <- !is.null(input$matnr_select) && input$matnr_select != "- not selected -"
if (!matr_selected) {
selectInput(
"name_select",
label = tags$label("Student Name:", class = "filter-label"),
choices = name_choices,
selected = input$name_select %||% "- not selected -"
)
} else {
div(
class = "static-text-container",
tags$label("Student Name:", class = "filter-label"),
div(
class = "static-text-input",
style = "margin-top: 0;",  # aligns with dropdowns
{
row <- students_sorted_name[
students_sorted_name$matriculation_number == input$matnr_select, ]
paste(row$first_name, row$last_name)
}
)
)
}
})
# ============================================================================
# Dynamic UI: Matriculation Number
# ============================================================================
output$matnr_ui <- renderUI({
req(input$student_toggle == "One Student")
name_selected <- !is.null(input$name_select) && input$name_select != "- not selected -"
matr_selected <- !is.null(input$matnr_select) && input$matnr_select != "- not selected -"
if (!name_selected) {
selectInput(
"matnr_select",
label = tags$label("Matriculation Number:", class = "filter-label"),
choices = matr_choices,
selected = input$matnr_select %||% "- not selected -"
)
} else {
div(
class = "static-text-container",
tags$label("Matriculation Number:", class = "filter-label"),
div(
class = "static-text-input",
style = "margin-top: 0;",  # aligns with dropdowns
{
row <- students_sorted_name[
students_sorted_name$full_name == input$name_select, ]
row$matriculation_number
}
)
)
}
})
# ============================================================================
# Show / Hide Reset Button
# ============================================================================
observe({
if (
(!is.null(input$name_select) && input$name_select != "- not selected -") ||
(!is.null(input$matnr_select) && input$matnr_select != "- not selected -")
) {
shinyjs::show("reset_filters")
} else {
shinyjs::hide("reset_filters")
}
})
# ============================================================================
# Reset all dropdowns
# ============================================================================
observeEvent(input$reset_filters, {
updateSelectInput(session, "name_select", selected = "- not selected -")
updateSelectInput(session, "matnr_select", selected = "- not selected -")
})
# ============================================================================
# Compute GPA for selected student
# ============================================================================
output$student_gpa <- renderText({
req(input$student_toggle == "One Student")
selected_matr <- input$matnr_select
selected_name <- input$name_select
# Resolve matriculation number
if (!is.null(selected_matr) && selected_matr != "- not selected -") {
matr <- selected_matr
} else if (!is.null(selected_name) && selected_name != "- not selected -") {
row <- students_sorted_name[students_sorted_name$full_name == selected_name, ]
matr <- row$matriculation_number
} else {
return("-")
}
# Load grades
student_grades <- dbGetQuery(
con,
paste0("SELECT grade FROM grade WHERE matriculation_number = '", matr, "'")
)
if (nrow(student_grades) == 0) return("-")
round(mean(student_grades$grade, na.rm = TRUE), 2)
})
# Disconnect DB when session ends
session$onSessionEnded(function() dbDisconnect(con))
}
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
